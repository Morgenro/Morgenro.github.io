---
title: 模型提取攻击摸索
date: 2026-01-07 20:54:31
tags: [AI安全, 模型窃取, 深度学习]
description: "摸索模型提取攻击（MEA）在不同反馈机制下的实现路径及防御对抗。"
---

   本文记录了我针对“模型提取攻击（Model Extraction Attacks, MEAs）”进行的摸索。模型窃取本质上是利用黑盒接口的查询-响应机制，通过训练影子模型（Substitute Model）来复制靶机模型（Victim Model）的决策逻辑

   整个研究从最初的简单的基准模型的训练开始,到软标签（Soft-label）窃取，再到硬标签（Hard-label）环境下的决策边界探测以及有防御策略下的窃取.相关的攻击和防御策略如下

### 攻击 
#### 攻击方法
- **替代模型训练 (Substitute Model Training)：** 利用查询反馈训练功能等价的影子模型。
- **方程求解与参数还原：** 针对简单模型或特定激活函数（如 ReLU）进行权重窃取。
- **解释引导与梯度估计：** 利用热力图或样本梯度加速窃取（如 SPSG 策略）。
#### 攻击数据选择

- **问题域攻击 (Problem Domain)：** 使用与靶机同分布的数据（如本项目对 CIFAR-10 的划分）。
- **非问题域攻击 (Non-problem Domain)：** 利用无关数据通过领域自适应完成提取（如 **Marich** 策略）。
- **无数据攻击 (Data-free)：** 完全依赖 GAN 生成查询样本。

### 防御

- **攻击预防 (Prevention)：** 包含 **对抗训练**（增强鲁棒性）、**输出/数据扰动**（如加入 $\epsilon$-DP 噪声）、**访问控制**（基于速率限制或 PoW）。
- **监测与验证 (Detection & Verification)：**
  - **查询模式监控：** 如 **PRADA** 监测查询分布的统计偏差 。
  - **所有权水印 (Watermarking)：** 在模型中嵌入特定 trigger 以便后事追溯所有权。
  - **指纹识别 (Fingerprinting)：** 利用边界特征生成唯一模型标识。

## 环境配置

Python

```
torch==2.5.1
torchvision==0.20.1
numpy==2.2.6
scipy==1.15.3
scikit-learn==1.7.2
pillow==12.1.0
scikit-image==0.25.2
tqdm==4.67.1
matplotlib==3.10.8
```

### Stage 0:基准模型的训练

靶机采用 ResNet-18 架构，在 CIFAR-10 数据集上进行训练

选择一些常见的训练策略:比如通过TrivialAugmentWide进行数据增强;引入标签平滑;还有经典的针对cifar的7x7卷积层改为3x3卷积层.使用单周期学习策略加速训练和Nesterov加速梯度减少震荡

50epoch后的基准模型的准确率为94%
```因为我采用的是问题域攻击,所以我采取了cifai-10的前50%训练集进行训练,后50%训练集进行攻击```
### Stage 1: 软标签窃取
软标签窃取使用了四种不同的策略,分别是:
  基础软标签提取(基准策略):使用KL 散度作为损失函数，让替代模型的输出尽可能接近目标模型的输出分布。
```python
  # 核心逻辑：利用 KL 散度让替代模型学习目标模型的输出分布
T = 3.0  # 温度系数，用于平滑概率分布

with torch.no_grad():
    # 1. 获取受害者的软标签（包含类间关系信息）
    target_logits = target_model(inputs)
    target_soft = F.softmax(target_logits / T, dim=1)

# 2. 替代模型进行预测并计算损失
sub_logits = substitute_model(inputs)
sub_log_soft = F.log_softmax(sub_logits / T, dim=1)

# 3. KLDivLoss 核心：最小化两个分布之间的差异
loss = criterion_kl(sub_log_soft, target_soft) * (T * T)
```
  基于随机擦除的提取:增加了训练中对原图随机擦掉一块区域方法进行的窃取
  MARICH (Multi-stage Active Model Extraction):通过主动学习(熵采样;K-Means)筛选出最“值得”查询的样本，提高查询效率。
  SPSG (SuperPixel Soft-label Gradient) 梯度纯化提取:通过超像素分割 (SLIC),通过梯度提取和梯度纯化进行窃取
实验结果:

### Stage 2: 硬标签窃取 


### Stage 3: 防御干扰下的窃取
